{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "access-analyzer:*",
                "acm:*",
                "acm-pca:*",
                "account:*",
                "airflow:*",
                "amplify:*",
                "apigateway:*",
                "appconfig:*",
                "application-autoscaling:*",
                "appmesh:*",
                "appsync:ListGraphqlApis",
                "artifact:*",
                "athena:*",
                "auditmanager:*",
                "autoscaling:*",
                "aws-marketplace:*",
                "aws-portal:*",
                "backup-storage:*",
                "backup:*",
                "batch:*",
                "budgets:*",
                "catalog-admin:*",
                "catalog-user:*",
                "ce:*",
                "chatbot:*",
                "cloud9:*",
                "clouddirectory:*",
                "cloudformation:*",
                "cloudfront:*",
                "cloudhsm:*",
                "cloudshell:*",
                "cloudtrail:*",
                "cloudwatch:*",
                "codebuild:*",
                "codecommit:*",
                "codedeploy:*",
                "codeguru-reviewer:*",
                "codepipeline:*",
                "codestar:*",
                "codestar-connections:*",
                "codestar-notifications:*",
                "cognito-identity:*",
                "cognito-idp:*",
                "cognito-sync:*",
                "compute-optimizer:*",
                "config:*",
                "connect:*",
                "controltower:*",
                "databrew:*",
                "datapipeline:*",
                "datasync:*",
                "dax:*",
                "directconnect:*",
                "dlm:*",
                "dms:*",
                "ds:*",
                "dynamodb:*",
                "ebs:*",
                "ec2:*",
                "ec2messages:*",
                "ecr:*",
                "ecs:*",
                "eks:*",
                "elasticache:*",
                "elasticbeanstalk:*",
                "elasticfilesystem:*",
                "elasticloadbalancing:*",
                "elasticmapreduce:*",
                "emr-serverless:*",
                "es:*",
                "events:*",
                "evidently:*",
                "execute-api:*",
                "firehose:*",
                "fis:*",
                "forecast:*",
                "fsx:*",
                "glacier:*",
                "globalaccelerator:*",
                "glue:*",
                "guardduty:*",
                "health:*",
                "iam:*",
                "imagebuilder:*",
                "inspector:*",
                "inspector2:*",
                "kafka:*",
                "kafka-cluster:*",
                "kafkaconnect:*",
                "kendra:*",
                "kinesis:*",
                "kinesisanalytics:*",
                "kms:*",
                "lakeformation:*",
                "lambda:*",
                "lex:*",
                "license-manager:*",
                "logs:*",
                "macie2:*",
                "macie:*",
                "mediaconvert:*",
                "mgh:*",
                "mgn:*",
                "mobiletargeting:*",
                "mq:*",
                "neptune-db:*",
                "network-firewall:*",
                "organizations:DescribeOrganization",
                "pi:*",
                "polly:*",
                "quicksight:*",
                "ram:*",
                "rds-db:connect",
                "rds:*",
                "redshift:*",
                "redshift-data:*",
                "resource-explorer:*",
                "resource-groups:*",
                "route53:*",
                "route53resolver:*",
                "rum:*",
                "s3:*",
                "sagemaker:*",
                "secretsmanager:*",
                "securityhub:*",
                "servicecatalog:*",
                "servicediscovery:*",
                "servicequotas:*",
                "ses:*",
                "shield:*",
                "snowball:*",
                "sns:*",
                "sqs:*",
                "ssm:*",
                "ssmmessages:*",
                "sso:*",
                "states:*",
                "storagegateway:*",
                "sts:*",
                "support:*",
                "swf:*",
                "synthetics:*",
                "tag:*",
                "textract:*",
                "transfer:*",
                "trustedadvisor:*",
                "waf-regional:*",
                "waf:*",
                "wafv2:*",
                "wam:*",
                "wellarchitected:*",
                "workdocs:*",
                "workspaces:*",
                "xray:*"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowApprovedServices"
        },
        {
            "Action": [
                "cloudtrail:DeleteT*",
                "cloudtrail:StopL*",
                "cloudtrail:UpdateT*",
                "config:Dele*",
                "config:Stop*",
                "ec2:*ClassicL*",
                "ec2:*Defa*",
                "ec2:*NatG*",
                "ec2:*TransitG*",
                "ec2:*Vpn*",
                "ec2:A*Gatew*",
                "ec2:A*ReservedI*",
                "ec2:A*Route*",
                "ec2:A*Subn*",
                "ec2:A*Vpc*",
                "ec2:AdvertiseB*",
                "ec2:AssociateDh*",
                "ec2:C*Gatew*",
                "ec2:C*ReservedI*",
                "ec2:C*Route*",
                "ec2:C*Subn*",
                "ec2:C*Vpc*",
                "ec2:CreateDh*",
                "ec2:CreateFlo*",
                "ec2:Del*Gatew*",
                "ec2:Del*Route*",
                "ec2:Del*Subn*",
                "ec2:Del*Vpc*",
                "ec2:DeleteDh*",
                "ec2:DeleteFlo*",
                "ec2:DeprovisionB*",
                "ec2:Det*Gatew*",
                "ec2:Dis*Route*",
                "ec2:Dis*Vpc*",
                "ec2:DisassociateSubn*CidrB*",
                "ec2:E*Route*",
                "ec2:ImportIm*",
                "ec2:ImportIn*",
                "ec2:ImportV*",
                "ec2:M*ReservedI*",
                "ec2:M*Vpc*",
                "ec2:ModifySnapshotA*",
                "ec2:ModifyTraf*",
                "ec2:ProvisionB*",
                "ec2:Pur*",
                "ec2:R*Route*",
                "ec2:RestoreA*",
                "ec2:Withd*",
                "elasticache:PurchaseR*",
                "guardduty:Delete*",
                "guardduty:DisassociateF*",
                "guardduty:DisassociateM*",
                "guardduty:StopM*",
                "ram:A*",
                "ram:C*",
                "ram:D*",
                "ram:E*",
                "ram:R*",
                "ram:U*",
                "rds:PurchaseR*",
                "redshift:AcceptR*",
                "redshift:PurchaseR*",
                "securityhub:Dis*",
                "sso-directory:*"
            ],
            "Resource": "*",
            "Effect": "Deny",
            "Sid": "HighRiskAPIs"
        },
        {
            "Action": [
                "iam:*AccessK*",
                "iam:*AccountP*",
                "iam:*Group*",
                "iam:*LoginP*",
                "iam:*MFAD*",
                "iam:*SAMLP*",
                "iam:*SSHP*",
                "iam:AttachU*",
                "iam:CreateP*",
                "iam:CreateU*",
                "iam:DeleteAccountA*",
                "iam:DeleteI*",
                "iam:DeleteP*",
                "iam:DeleteSi*",
                "iam:DeleteU*",
                "iam:DetachU*",
                "iam:PutR*",
                "iam:PutU*",
                "iam:SetD*",
                "iam:TagU*",
                "iam:UntagU*",
                "iam:UpdateSi*",
                "iam:UpdateU*",
                "iam:UploadSe*"
            ],
            "Resource": "*",
            "Effect": "Deny",
            "Sid": "DenySensitiveIAMActions"
        },
        {
            "Condition": {
                "StringNotEquals": {
                    "iam:PermissionsBoundary": "arn:aws:iam::xxx20217:policy/cms-cloud-admin/developer-boundary-policy"
                }
            },
            "Action": [
                "iam:CreateR*"
            ],
            "Resource": [
                "arn:aws:iam::xx719920217:role/delegatedadmin/developer/*"
            ],
            "Effect": "Deny",
            "Sid": "RequirePermissionsBoundaryForRoleCreation"
        },
        {
            "Action": [
                "iam:AttachR*",
                "iam:DeleteRole",
                "iam:DeleteRolePo*",
                "iam:DetachR*",
                "iam:PutRolePo*",
                "iam:UpdateAs*",
                "iam:UpdateR*",
                "iam:CreateI*",
                "iam:AddR*",
                "iam:RemoveR*"
            ],
            "Effect": "Deny",
            "Sid": "DenyNonDelegatedRoles",
            "NotResource": [
                "arn:aws:iam::xxx19920217:role/delegatedadmin/developer/*",
                "arn:aws:iam::xxx19920217:instance-profile/delegatedadmin/developer/*"
            ]
        },
        {
            "Condition": {
                "StringNotLike": {
                    "aws:PrincipalArn": "*ct-ado-qpp*"
                }
            },
            "Action": [
                "iam:PassRole"
            ],
            "Effect": "Deny",
            "Sid": "RestrictIamPassRole",
            "NotResource": [
                "arn:aws:iam::*:role/delegatedadmin/developer/*",
                "arn:aws:iam::*:role/cms-cloud-admin/developer-PassAllowed/*",
                "arn:aws:iam::*:role/aws-service-role/*"
            ]
        },
        {
            "Action": [
                "logs:DeleteLogG*",
                "logs:DeleteRet*",
                "logs:PutDestination",
                "logs:DeleteLogS*"
            ],
            "Resource": [
                "arn:*:logs:*:*:log-group:/aws/ec2/*",
                "arn:*:logs:*:*:log-group:*accesslogs*",
                "arn:*:logs:*:*:log-group:cloudtrail-logs*",
                "arn:*:logs:*:*:vpc-flowlogs*",
                "arn:*:logs:*:*:waf-accesslogs*"
            ],
            "Effect": "Deny",
            "Sid": "DenyLogTampering"
        },
        {
            "Condition": {
                "StringNotEquals": {
                    "aws:RequestedRegion": [
                        "us-east-1",
                        "us-west-2",
                        "us-gov-west-1",
                        "us-gov-east-1"
                    ]
                }
            },
            "Resource": "*",
            "Effect": "Deny",
            "NotAction": [
                "chatbot:*",
                "iam:*",
                "trustedadvisor:*"
            ],
            "Sid": "DenyNonApprovedRegions"
        }
    ]
}
